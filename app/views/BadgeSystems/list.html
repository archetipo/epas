#{extends 'main3.html' /}
#{set header:'navbar' /}
#{set title: 'ePAS - Gestione sedi'  /}

<div class="container">
	#{title title:'Badge System' /}

	
	#{alert color:'info'}
	  <p>Tutti i codici badge associati a un <strong class="text-primary">&{'badgeSystem'} 
	  	<i class="fa fa-credit-card"></i><i class="fa fa-credit-card"></i><i class="fa fa-credit-card"></i></strong>
	  </p> 
	  
	  <p>
	  1) Sono abilitati a timbrare nelle medesime <strong class="text-primary">&{'badgeReaders'} <i class="fa fa-database"></i></strong>
	  </p>
	  <p>
	  2) Possono essere attribuiti ai dipendenti delle <strong class="text-primary">Sedi Abilitate <i class="fa fa-institution"></i></strong>
	  </p>
	#{/alert}
	
	#{form action:@BadgeSystems.list(), class:'form-inline', method:'GET',
    'data-reload':'#results', autocomplete:'off'}

    <div class="row">
     <div class="col-sm-3">
        #{f.input 'name', 'data-autochange':true, value:name, autofocus:true,
            placeholder:'search'.label(), inline:true /}
     </div>
     <div class="col-sm-1">
        <button type="submit" name="_filter" class="btn btn-primary">
            <i class="fa fa-search"></i> <span class="sr-only">&{'search'}</span>
        </button>
     </div>
    </div>
	#{/form}

	
	#{secure.checkAction 'BadgeSystems.blank'}
	  #{b.actions}
	    <a class="btn btn-success" href="@{blank()}" data-async-modal="#defaultModal">
	      <i class="fa fa-plus"></i> &{'BadgeSystems.blank'}
	    </a>
      #{/b.actions}
    #{/secure.checkAction}
	
	<div id="badgeSystemList"> <!-- per il risultato della modale asincrona -->
	
	<section id="results">
    #{paginate results} 
	   <ul class="list-group">
	   #{list items:results.results, as:'item'}
	   
		 <li class="list-group-item list-group-item-grey">
		 
		   <h4 style="color: black">	
	         <i class="fa fa-credit-card"></i><i class="fa fa-credit-card"></i><i class="fa fa-credit-card"></i>
	         <a class="list-group-item-heading" href="@{edit(item.id)}">
			    ${item.name}
	    	 </a>
	       </h4>
	       <div class="container">
		       <p>Istituto Responsabile del Badge System <strong>${item.owner.name}</strong></p>
		       #{list items:item.badgeReaders, as:'badgeReader'}
		       <p><i class="fa fa-database"></i> ${badgeReader.code}</p>
		       #{/list}
		       #{list items:item.offices, as:'office'}
		       <p><i class="fa fa-institution"></i> ${office.name}</p>
		       #{/list}
	       </div>
	     </li>
	    
	   #{/list}
	   </ul>
    #{/paginate} 
     </section>
     </div>
</div>

