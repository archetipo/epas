#{extends 'main3.html' /}
#{set header:'navbar' /}
#{set title: 'ePAS - Modifica ' + contract.person.fullname /}

#{set breadcrumbs:['Lista Persone':@Persons.list(), 
  (contract.person.fullname):@Contracts.personContracts(contract.person.id), 
  'Gestisci Contratto':null] /}
#{breadcrumbs breadcrumbs, noHome:true, container:true /}

#{contracts.editContractTabs activeAction:'updateContractWorkingTimeType' /}

<div class="container" id="updateWtt">

<table class="table table-bordered table-condensed center">
  <tr>
    <th>Dal</th>
    <th>Al</th>
	<th>Tip Orario</th>
  </tr>
  #{list items:contract.contractWorkingTimeType, as:'cwttItem'}
  <tr>
    <td>${cwttItem.beginDate}</td>
	<td>#{if cwttItem.endDate} ${cwttItem.endDate} #{/if}#{else}<em>Indeterminato</em>#{/else}</td>
	<td>${cwttItem.workingTimeType.description}</td>
  </tr>
  #{/list}
</table>

<div class="alert alert-info">
Il software richiede che per ogni giorno di contratto sia specificato uno e uno solo tipo di orario.
  Con questa procedura guidata è possibile definire in modo sicuro il tipo orario per ogni singolo periodo del contratto
  <p>Data inizio contratto: <strong>${contract.beginContract.format()}</strong></p>
  <p>Data fine contratto: 
  <strong>
    #{if contract.expireContract}${contract.expireContract.format()}#{/if}
    #{else}<em>Indeterminato</em>#{/else}
  </strong>
  </p>
  <p><i class="fa fa-bell"></i> Per sicurezza in caso di ricalcoli necessari verrà visualizzato un riepilogo delle modifiche e chiesto un comando di conferma. </p>
</div>

#{form action:@Contracts.changeTypeOfContractWorkingTimeType(), class:'form-horizontal',
		'data-async':'#updateWtt', 'data-async-error':'#updateWtt', 'data-spinner':'#defaultSpinner' }
		
	        #{f.hidden 'cwtt.contract.id' /}
	        #{f.date 'cwtt.beginDate', value:cwtt.beginDate?.format(), required:true /}
	        #{f.date 'cwtt.endDate', value:cwtt.endDate?.format() /}
	        #{f.selectModel 'cwtt.workingTimeType', 	
	        items:templateUtility.getEnabledWorkingTimeTypeForOffice(cwtt.contract.person.office), required:true /}
	        
	        #{b.buttons center:true}
	            #{b.submit 'Applica'/}
	        #{/b.buttons}
#{/form}


</div>