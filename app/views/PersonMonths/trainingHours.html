#{extends 'main3.html' /}
#{set header:'navbar' /}
#{set title:'Ore di formazione per ' + person.surname + ' ' + person.name + ' anno: ' + year /}



<div class="row">

<div class="panel panel-info">
	<div class="panel-heading">
	<p class="lead">Le ore di formazione possono essere inserite solo per il mese selezionabile. Nel momento in cui l'amministratore le approva non potranno più essere modificate.</p>
	</div>
  	<div class="panel-body">
    <table class="table table-hover span9">
	<tr>
		<th>Mese</th>
		<th>Ore di formazione</th>
		<th>Modifica</th>
		<th>Approvate</th>
		
	</tr>
	
	
	#{list items:mesi, as: 'mese'}
	<tr>
		<td class="text-error">&{'views.tags.display.date.month.' +mese}</td>
		<td>
			<ul>			
			#{list items:pmList, as: 'pm'}
				#{if pm != null}
				  #{if pm.month == mese}	
					#{if mese == date.getMonthOfYear() || (mese == date.getMonthOfYear()-1 && pm.hoursApproved == false)}		
					  <li>
						<a data-toggle="modal" data-placement="bottom" title="Modifica ore di formazione" href="@{PersonMonths.modifyTrainingHours(pm.id)}" data-target="#myModal2">
						<b>${pm.trainingHours}</b> ore <b>Da:</b> <u>${pm.fromDate}</u> <b>A:</b> <u>${pm.toDate}</u></a>
						<a data-toggle="modal" data-placement="bottom" title="Elimina ore di formazione" href="@{PersonMonths.deleteTrainingHours(pm.id, year, month)}" data-target="#myModal3" ><i class="icon-minus-sign icon-large"></i></a>
					  </li>
					#{/if}
					#{else}
					  <li><b>${pm.trainingHours}</b> ore <b>Da:</b> <u>${pm.fromDate}</u> <b>A:</b> <u>${pm.toDate}</u></li>	
					#{/else}
				  #{/if}
				
				#{/if}
			#{/list}
			</ul>
		</td>
		<td>
			#{if mese == date.getMonthOfYear()}
				<a href="@{PersonMonths.insertTrainingHours(person.id, mese, year)}" data-modal="#myModal1">Inserisci ore di formazione</a>
			#{/if}
			
		</td>
		<td>
			#{if pm != null && pm.month == mese }
				#{if mese == date.getMonthOfYear() || mese == date.getMonthOfYear()-1}
					#{if pm.hoursApproved == true}
						SI<br>
					#{/if}
					#{else}
						NO<br>
					#{/else}			
				#{/if}
			#{/if}
			
		</td>
	</tr>
	#{/list}
</table>
  </div>
</div>


</div>


<p class="lead"><a href="@{PersonMonths.insertTrainingHours(person.id, date.getMonthOfYear()-1, year)}" data-modal="#myModal1">Inserisci ore di formazione del mese precedente se non ancora approvato</a></p>






<div id="myModal1" class="modal hide fade mymodal-small" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Inserisci ore di formazione</h3>
  </div>
  <div class="modal-body">
    <p></p>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
  </div>
</div>

<div id="myModal2" class="modal hide fade mymodal-small" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Modifica ore di formazione</h3>
  </div>
  <div class="modal-body">
    <p></p>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
  </div>
</div>

<div id="myModal3" class="modal hide fade mymodal-small" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Cancella ore di formazione</h3>
  </div>
  <div class="modal-body">
    <p></p>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
  </div>
</div>


