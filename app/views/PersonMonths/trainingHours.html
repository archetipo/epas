#{extends 'main3.html' /}
#{set header:'navbar' /}
#{set title: 'ePAS - Ore Formazione'  /}

#{set 'moreStyles'}

<style>
    
  p {
	display: inline-block;
	color: black;
	font-size: 1.2em;
  }
  
  p span {
    display: inline-block; 
    color: black; 
    font-size: .8em;
  }
  
  #before-table {
  	margin-bottom: 10px;
  }

</style>

#{/set}

<div class="container">

<div class="panel panel-info">
	<div class="panel-heading">
	  <h3 class="panel-title text-center">Ore di formazione ${person.surname} ${person.name} per l'anno ${year}</h3>
	</div>
  	<div class="panel-body">
  	
  	<div class="col-xs-1">
      <h3 class="text-right text-danger"><i class="fa fa-info-circle"></i></h3>
    </div>
  	<div class="col-xs-11" id="before-table">
  	  Le ore di formazione possono essere inserite solo per il mese selezionabile.<br> 
  	            Nel momento in cui l'amministratore le approva non potranno pi√π essere modificate.
  	</div>
  	
    <table class="table table-condensed center">
	  <tr class="info">
		<th>Mese</th>
		<th>Ore di formazione</th>
		<th>Modifica</th>
		<th>Approvate</th>
		
	  </tr>
	
	
	  #{list items:mesi, as: 'mese'}
	  <tr>
		<td class="warning">&{'views.tags.display.date.month.' +mese}</td>
		<td>
			<ul class="list-group">			
			#{list items:pmList, as: 'pm'}
				#{if pm != null}
				  #{if pm.month == mese}	
					#{if mese == today.getMonthOfYear() || (mese == today.minusMonths(1).getMonthOfYear() && pm.hoursApproved == false)}		
					  <li class="list-group-item list-group-item-info" >
					    <p>
					      <span class="label label-success">${pm.trainingHours} ore</span>
					      <span><b>Da:</b> ${pm.fromDate?.format()}</span>
					      <span><b>A:</b> ${pm.toDate?.format()}</span>
					    </p>
						<a data-toggle="modal" data-placement="bottom" title="Modifica ore di formazione" href="@{PersonMonths.modifyTrainingHours(pm.id)}" data-target=".my-modal"><i class="fa fa-pencil"></i></a>
						
						<a data-toggle="modal" data-placement="bottom" title="Elimina ore di formazione" href="@{PersonMonths.deleteTrainingHours(pm.person.id, pm.id)}" data-target=".my-modal" ><span class="glyphicon glyphicon-trash"></span></i></a>
					  </li>
					#{/if}
					#{else}
					  <li><b>${pm.trainingHours}</b> ore <b>Da:</b> <u>${pm.fromDate?.format()}</u> <b>A:</b> <u>${pm.toDate?.format()}</u></li>	
					#{/else}
				  #{/if}
				
				#{/if}
			#{/list}
			</ul>
		</td>
		<td>
			#{if mese == today.getMonthOfYear() && year == today.getYear()}
				<a data-toggle="modal" data-placement="bottom" title="Inserisci ore di formazione" href="@{PersonMonths.insertTrainingHours(mese, year)}" data-target=".my-modal">Inserisci ore di formazione</a>
			#{/if}
			
		</td>
		<td>
			#{if pm != null && pm.month == mese }
				#{if mese == today.getMonthOfYear() || mese == today.minusMonths(1).getMonthOfYear()}
					#{if pm.hoursApproved == true}
						SI<br>
					#{/if}
					#{else}
						NO<br>
					#{/else}			
				#{/if}
			#{/if}
			
		</td>
	  </tr>
	  #{/list}
    </table>
    
    <div class="col-xs-1">
      <h3 class="text-right"><i class="fa fa-pencil"></i></h3>
    </div>
  	<div class="col-xs-11">
  	  <a data-toggle="modal" data-placement="bottom" href="@{PersonMonths.insertTrainingHoursPreviousMonth()}" data-target=".my-modal">
  	  Modifica ore di formazione del mese precedente se non ancora approvate</a>
  	</div>
    
  </div>
</div>


</div>


<div class="modal fade my-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-center">
    
    <div class="modal-content">
             
    </div><!-- /.modal-content -->
           
    
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->






