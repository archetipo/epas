#{extends 'main.html' /}
#{set title:monthRecap.person.surname + ' ' + monthRecap.person.name + ', matricola=' + monthRecap.person.number /}

<h2 align="center">Situazione presenze mensile <span class="capitalized">&{'views.tags.display.date.month.' + monthRecap.month}</span> ${monthRecap.year}</h2>

<br>

<div align="right">
#{form @Application.logout()}
	
    	<input type="submit" value="Account logout" />
     

#{/form}
</div>
<div align="left">
#{form @Stampings.recharge()}
	<select name="anno">
		<option value="2011">2011</option> 
		<option value="2012">2012</option> 
		<option value="2013">2013</option> 

	</select>

	<select name="mese">
		<option value="1">Gennaio</option> 
		<option value="2">Febbraio</option> 
		<option value="3">Marzo</option> 
		<option value="4">Aprile</option>
		<option value="5">Maggio</option> 
		<option value="6">Giugno</option> 
		<option value="7">Luglio</option> 
		<option value="8">Agosto</option> 
		<option value="9">Settembre</option> 
		<option value="10">Ottobre</option> 
		<option value="11">Novembre</option> 
		<option value="12">Dicembre</option> 

	</select>
	
		<input type="submit" name="recharge" value="Submit">
#{/form}

</div>

	
<br>
<br>


<table id="presenze_mensili">
	<tr>
		<th width="5%">Buono mensa</th>
		<th>Giorno</th>
		<th width="80">Codice di assenza</th>
		<th>1째 entrata</th>
		<th>1째 uscita</th>
		<th>2째 entrata</th>
		<th>2째 uscita</th>
		<th>Tempo lavoro</th>
		<th>Differenza</th>
		<th>Progressivo</th>
		<th>Tipo Orario</th>
	</tr>
	
%{
     for(day in monthRecap.days) {
}%
		<tr>
			<td>${String.format(messages.get('views.common.yes_or_no.'+ day.mealTicket()))}</td>
			<td class="capitalized">${String.format(messages.get('views.tags.display.date.format.dayAndShortDayName'), day.date.toDate())}</td>
			<td>${day.absenceList().size()>0  ? day.absenceList().get(0).absenceType.code : ''}</td>
			<td>${day.getStampings().size()>0 && day.getStampings().size()==2 ? day.getStampings().get(0).date.toCalendarTime() : ''}</td>
			<td>${day.getStampings().size()>1 ? day.getStampings().get(1).date.toCalendarTime() : ''}</td>
			<td>${day.getStampings().size()>2 ? day.getStampings().get(2).date.toCalendarTime() : ''}</td>
			<td>${day.getStampings().size()>3 ? day.getStampings().get(3).date.toCalendarTime() : ''}</td>
			<td>${String.format("%02d", (day.timeAtWork()/60).toInteger())}:${day.timeAtWork()%60 } <b>${day.getStampings().size()==2 ? day.checkTimeForLunch(day.getStampings()).code : ''}</b></td>
			<td>${day.difference > 0 ? day.difference : 0} minuti </td>
			<td>${monthRecap.getProgressive(day.difference)} minuti</td>			
			<td>${day.person.workingTimeType != null ? day.person.workingTimeType.description : ''}</td>
		</tr>


%{  		   
     }
     
}%

</table>

*{Significato codici assenza}*
<div>
<h3 align="left">Note:</h3>
<table id="Note timbrature">
	<tr>
		<th width="80">Codice timbratura</th>
		<th width="400">Descrizione</th>
			
	</tr>

	<tr>
		<td>${monthRecap.getStampingCode().code}</td>     
		<td>${monthRecap.getStampingCode().description}</td>		
	</tr>


</table>

<br>
<br>
<h3 align="left">Tabella codici di assenza</h3>
<table id="Codici di assenza">
	<tr>
		<th width="80">Codice assenza</th>
		<th width="200">Descrizione</th>
		<th width="80">Numero giorni</th>
			
	</tr>
%{
     for(entry in monthRecap.getAbsenceCode().entrySet()) {
}%
	<tr>
		<td>${entry.getKey().code}</td>     
		<td>${entry.getKey().description}</td>	
		<td>${entry.getValue()}</td>	
	</tr>

%{  		   
     }
     
}%
</table>
</div>