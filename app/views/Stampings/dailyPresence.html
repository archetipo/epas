#{extends 'main_admin_no_menu.html' /}
#{set titolo: 'Situazione presenze del giorno ' + day + ' ' + month_capitalized + ' ' + year/}

<br>
<div class="container">
<div class="span10">
 <table id="tabellonetimbrature" class="table table-bordered table-condensed table-hover custom1">
      <tr>
		<th>Nome</th>
		<th>Assenza</th>
		<th>Tempo Lavoro</th>
		#{list items:1..numberOfInOut, as:'i'}
			<th>${i}° entrata</th>
			<th>${i}° uscita</th>
		#{/list}
		<th>Buono Mensa</th>
	  </tr>


	#{list items:daysRecap, as:'dayRecap'}
	<tr>
		<td class="caratteristica"><a href="@{Stampings.personStamping(dayRecap.person.id,year,month)}">${dayRecap.person.name} ${dayRecap.person.surname}</a></td>
		
		<td>
		  #{list items:dayRecap.absences, as:'absence'}
		      ${absence.absenceType.code}
		  #{/list}	
		</td>
		
		<td class="tempoLavoro">
		  ${dayRecap.workTime}
		  #{ifnot dayRecap.todayLunchTimeCode.equals("")}
		    <strong>${dayRecap.todayLunchTimeCode}</strong>
		  #{/ifnot}
		  #{ifnot dayRecap.fixedWorkingTimeCode.equals("")}
		  	<strong>${dayRecap.fixedWorkingTimeCode}</strong>
		  #{/ifnot}	
		  #{ifnot dayRecap.exitingNowCode.equals("")}
		    <strong>${dayRecap.exitingNowCode}</strong>
		  #{/ifnot}
		</td>	
		
		
		#{list items:dayRecap.stampingsTemplate, as:'stampingTemplate'}
		  #{if stampingTemplate.colour.equals("in")}
			<td class="position${stampingTemplate.pairPosition} pair${stampingTemplate.pairId} ">
		  #{/if}
		  #{elseif stampingTemplate.colour.equals("out")}
		    <td class="position${stampingTemplate.pairPosition} pair${stampingTemplate.pairId} ">
		  #{/elseif}
		  #{elseif stampingTemplate.colour.equals("warn")}
		    <td class="position${stampingTemplate.pairPosition} pair${stampingTemplate.pairId} warn">
	      #{/elseif}
					
		  #{if stampingTemplate.date!=null}
		  	  ${stampingTemplate.hour}
		  #{/if}
		  #{elseif stampingTemplate.pairPosition.equals("center")}
		    <abbr title="Timbratura di servizio mancante" class="initialism"><i class="icon-warning-sign"></i></abbr>
		  #{/elseif}

		  #{ifnot stampingTemplate.identifier.equals("")}
			<strong>${stampingTemplate.identifier}</strong>
		  #{/ifnot}	
		  #{ifnot stampingTemplate.markedByAdminCode.equals("")}
			<strong>${stampingTemplate.markedByAdminCode}</strong>
		  #{/ifnot}	
		  #{ifnot stampingTemplate.missingExitStampBeforeMidnightCode.equals("")}
			<strong>${stampingTemplate.missingExitStampBeforeMidnightCode}</strong>
		  #{/ifnot}	
		  <!--  ${stampingTemplate.pairId}${stampingTemplate.pairPosition}  -->		
		  </td>
	    #{/list}
	    
	      <td>
			#{if dayRecap.mealTicket.equals("NO")}
			  <i class="icon-ban-circle"></i>
			#{/if} 
			#{if dayRecap.mealTicket.equals("NOT_YET")}
			  <i class="icon-remove"></i>
			#{/if} 
			#{if dayRecap.mealTicket.equals("YES")}
			  <i class="icon-ok"></i>
			#{/if} 
		  </td>
	    
		
	</tr>	
	#{/list}
</table>
</div>
</div>