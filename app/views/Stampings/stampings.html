#{extends 'main3.html' /}
#{set header:'navbar' /}
#{set title: 'ePAS - Situazione Mensile'  /}

#{set 'moreStyles'}

<style>

  html, body {
  background-color: white;
  }me

  #page_content {
  padding-top: 70px;
  }

  .col-xs-12, .col-sm-12, .col-md-6 {
  padding-left: 4px;
  padding-right: 4px;
  }

  .panel-success>.panel-heading {
  color: black;
  background-color: grey;
  border-color: #dddddd;
  }

  .col-xs-10, .col-xs-2 { /* tabelle riepilogo responsive */
  border: 1px solid lightgrey;
  padding-top: 3px;
  padding-bottom: 3px;
  }

  .col-xs-2 {
  text-align: center;
  }

  .container {
  margin-left: 0;
  margin-right: 0;
  }

  /* The max width is dependant on the container (more info below) */
  .popover{
    max-width: 100%; /* Max Width of the popover (depending on the container!) */
  }

  #page_content {
  widht: 100%;
  }

  @media (max-width: 767px) {

  #tabellonetimbrature {
  font-size: 10px !important;
  /* min-width: 600px; */
  }

  #padre {
  /* min-width: 640px; */
  }

  .container {
  margin-left: 0px;
  padding-left: 0px;
  margin-right: 0px;
  padding-right: 0px;

  }

  footer {
  display: none;
  }

  #riepiloghi {
  font-size: 12px !important;
  }

</style>

#{/set}

<div class="col-xs-12 col-lg-8">
  <table id="tabellonetimbrature" class="table table-bordered table-condensed" cellspacing="0"
         width="100%">
    <thead>
    <tr>
      <th class="group-single">Giorno</th>
      <th class="group-single">Buono<br>pasto</th>

      <th class="invisible"></th>

      <th class="group-single">Codice <br>assenza</th>


      #{list items:1..psDto.numberOfInOut, as:'i'}
      <th class="group-left">${i}<sup>a</sup> <br/>entrata</th>
      <th class="group-right">${i}<sup>a</sup> <br/>uscita</th>
      #{/list}

      <th class="invisible"></th>

      <th class="group-single">Tempo<br>lavoro</th>
      <th class="group-single">Diffe-
</div><br/>renza</th>
<th class="group-single">Progres-<br/>sivo</th>
<th class="group-single hidden-xs hidden-sm">Tipo<br>Orario</th>
<th class="group-single hidden-xs hidden-sm">Note</th>
</tr>
</thead>
<tbody>
#{list items:psDto.daysRecap, as:'dayRecap'}
<tr #{if dayRecap.ignoreDay} class="ignore_day" #{/if}>
<td class="${dayRecap.holiday ? 'festivi' : 'capitalized'} default-single">
  ${dayRecap.date.shortDayName()}
</td>

<td class="default-single">
  #{if dayRecap.mealTicket.equals("NO")}
    <i class="fa fa-ban" popover-hover data-content="&{'mealTicket.notAquired'}"></i>
  #{/if}
  #{if dayRecap.mealTicket.equals("NOT_YET")}
   <i class="fa fa-spinner fa-spin" popover-hover data-content="&{'mealTicket.notYetAquired'}"></i>
  #{/if}
  #{if dayRecap.mealTicket.equals("YES")}
    <i class="fa fa-cutlery" popover-hover data-content="&{'mealTicket.aquired'}"></i>
  #{/if}
</td>

<td class="invisible"></td>

<td class="assenza default-single">
  #{list items:dayRecap.absences, as:'absence'}
				  <span>
				     ${absence.absenceType.code} 
				     #{if absence.justifiedMinutes}
				    	${absence.justifiedMinutes} min
				  	 #{/if}
				  </span>
  #{/list}
</td>


#{list items:dayRecap.stampingsTemplate, as:'stampingTemplate'}
#{if stampingTemplate.colour.equals("in")}
<td class="position${stampingTemplate.pairPosition} pair${stampingTemplate.pairId} default-left">
  #{/if}
  #{elseif stampingTemplate.colour.equals("out")}
<td class="position${stampingTemplate.pairPosition} pair${stampingTemplate.pairId} default-right">
  #{/elseif}
  #{elseif stampingTemplate.colour.equals("warn")}
<td class="position${stampingTemplate.pairPosition} pair${stampingTemplate.pairId} warn">
  #{/elseif}

  #{if stampingTemplate.date!=null}
  *{ <a data-toggle="modal" href="@{Stampings.editEmployee(stampingTemplate.stampingId)}"
        data-modal=".my-modal">
  ${stampingTemplate.hour}
</a> }* ${stampingTemplate.hour}
  #{/if}
  #{elseif stampingTemplate.pairPosition.equals("center")}
  <abbr title="Timbratura di servizio mancante" class="initialism"><i class="icon-warning-sign"></i></abbr>
  #{/elseif}

  #{ifnot stampingTemplate.identifier.equals("")}
  <strong>${stampingTemplate.identifier}</strong>
  #{/ifnot}
  #{ifnot stampingTemplate.markedByAdminCode.equals("")}
  <strong>${stampingTemplate.markedByAdminCode}</strong>
  #{/ifnot}
  #{ifnot stampingTemplate.markedByEmployeeCode.equals("")}
  <strong>${stampingTemplate.markedByEmployeeCode}</strong>
  #{/ifnot}
  #{ifnot stampingTemplate.missingExitStampBeforeMidnightCode.equals("")}
  <strong>${stampingTemplate.missingExitStampBeforeMidnightCode}</strong>
  #{/ifnot}
  <!--  ${stampingTemplate.pairId}${stampingTemplate.pairPosition}  -->
</td>
#{/list}

<td class="invisible"></td>

<td class="tempoLavoro default-single">
  ${dayRecap.workTime}
      #{if !dayRecap.workTimeExplanation.empty}
      <a href="#" popover-hover
         data-html="true"
         data-content="${(dayRecap.workTimeExplanation).escape()}"
         title="Riepilogo Tempo a lavoro"><i class="fa fa-info"></i>
      </a>
      #{/if}
  #{else}
  #{/else}

  #{ifnot dayRecap.todayLunchTimeCode.equals("")}
  <strong>${dayRecap.todayLunchTimeCode}</strong>
  #{/ifnot}
  #{ifnot dayRecap.fixedWorkingTimeCode.equals("")}
  <strong>${dayRecap.fixedWorkingTimeCode}</strong>
  #{/ifnot}
  #{ifnot dayRecap.exitingNowCode.equals("")}
  <strong>${dayRecap.exitingNowCode}</strong>
  #{/ifnot}
</td>

#{if dayRecap.differenceNegative}
<td class="differenza default-single" style="color: red;">${dayRecap.difference}</td>
#{/if}
#{else}
<td class="differenza default-single">&nbsp;${dayRecap.difference}</td>
#{/else}

#{if dayRecap.progressiveNegative}
<td class="progressivo default-single" style="color: red;">${dayRecap.progressive}</td>
#{/if}
#{else}
<td class="progressivo default-single">&nbsp;${dayRecap.progressive}</td>
#{/else}

<td class="default-single hidden-xs hidden-sm">
  #{if dayRecap.wtt!=null && dayRecap.wttd!=null}
    #{include './_workingTimeTypePopover.html' /}
  #{/if}

</td>
<td class="default-single hidden-xs hidden-sm">
  #{list items:dayRecap.note, as:'n'}
  <!--  ${n}<br> -->
  #{/list}
</td>
</tr>
#{/list}
</tbody>
</table>
</div>

<div id="riepiloghi">

  <div class="col-xs-12 col-sm-12 col-md-6 col-lg-4 left">
    #{include './_contractsRecap.html' /}
  </div>

  <div class="col-xs-12 col-sm-12 col-md-6 col-lg-4 right">
    #{include './_notes.html' /}
  </div>

</div>
