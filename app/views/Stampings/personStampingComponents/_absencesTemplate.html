<td class="assenza default-single">
  #{secure.link @AbsenceGroups.insert(dayRecap.personDay.person.id, dayRecap.personDay.date?.format()),
      target:person, display:'hidden', 'data-async-modal':'#modalGroupAbsence'}
      ___
  #{/secure.link}

  #{list items:dayRecap.personDay.absences, as:'absence'}


  #{secure.link @Absences.edit('absence.id':absence.id), target: absence, 'data-async-modal':'#modalAbsence'}
    
    <span webui-popover-hover data-url="#${absence.id}"
        *{ colore codice assenza }*
        #{if !absence.troubles.empty} 
          class="text-danger" 
        #{/if}
        #{else} 
          #{if absence.nothingJustified()} class="text-muted" #{/if}
        #{/else}
     >

	    #{if !absence.troubles.empty} <strong>${absence.absenceType.code}</strong> #{/if}
	    #{else} ${absence.absenceType.code} #{/else}
	    
	  </span>
  #{/secure.link}

  #{if absence.absenceFile.exists()}
    #{secure.link @Absences.downloadAttachment(absence.id), fa:'paperclip'}#{/secure.link}
  #{/if}

  <div class="webui-popover-content" id="${absence.id}">
    <strong>Codice</strong> ${absence.absenceType.code}<br>
    <strong>Descrizione</strong> ${absence.absenceType.description}
    
    #{if absence.justifiedType}
        #{if absence.justifiedAllDay() }
          <br><strong>Tempo giustificato</strong> &{absence.justifiedType}
        #{/if}
	    #{if absence.justifiedTime() }
	      <br><strong>Tempo giustificato</strong> ${absence.justifiedTime().printHourMinute()}
	    #{/if}
    #{/if}
    
    #{if !absence.troubles.empty}
         <br><br>  
         <p class="text-danger">Questa assenza contiene errori:</p>
         <ul>
         #{list items:absence.troubles, as:'trouble'}
           <li>&{trouble.trouble}</li>
         #{/list}
         </ul>
     #{/if}
  </div>

  #{/list}
</td>