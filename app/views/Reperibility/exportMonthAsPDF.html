<!DOCTYPE html>

<html>
    <head>
        <title>Istituto di Informatica e Telematica - Reperibilità di ${month} ${year}</title>
        <link rel="stylesheet" href="@{'/public/stylesheets/sistorgReportPDF.css'}" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="@{'/public/stylesheets/reperibilityPDF.css'}" type="text/css" charset="utf-8">
    </head>
    <body>
    		%{
    			mm = 0;
    			
       			mese = firstOfMonth.plusMonths(mm).monthOfYear().getAsText();
				anno = firstOfMonth.plusMonths(mm).year().getAsText();
    		}%
        	<h1>Istituto di Informatica e Telematica </h1>
        
        	<div class="table">
			<table class="mensile">
			<caption> Reperibilità del personale per il mese di ${mese} ${anno}</caption>
			<tr>
				<td class="no-border"></td><th colspan="2"> Feriali - Cod: ${codFr}</th> <th colspan="2" class="red"> Festivi - Cod: ${codFs}</th>
			</tr>
			<tr>
				<th>Nome dipendente  </th> <th> Date </th> <th> Num. giorni</th> <th> Date </th> <th>Num. giorni</th>
			</tr>
			
			%{
				for(person in reperibilitySumDays.rowKeySet()) {
			}%
			<tr>
				<td> ${person}</th>
				<td> 
					%{
						for(day in reperibilityDateDays.get(person, "FR")) {
					}%
						${day} <br/>
					%{
    					}
					}%
				</td>
				<td> ${reperibilitySumDays.contains(person, "FR") ? reperibilitySumDays.get(person, "FR") : ''}</td>
				<td> %{
						for(day in reperibilityDateDays.get(person, "FS")) {
					}%
						${day} <br/>
					%{
    					}
					}%
				</td>
				<td class="red"> ${reperibilitySumDays.contains(person, "FS") ? reperibilitySumDays.get(person, "FS") : '0'}</td>
			</tr>

			%{
    			}
			}%
			</table>
      		</div>
      		
			<div class="note">
			%{
				if (inconsistentAbsence != null) {
			}%
					<h2>Attenzione! </h2>
			    	<h3>Sono state rilevate le seguenti inconsistenze con le presenze del personale: </h3>
			    	<ul>
			%{    	
				for(person in inconsistentAbsence.rowKeySet()) {
					for(day in inconsistentAbsence.columnKeySet()) {
						if (inconsistentAbsence.contains(person, day)) {

			}%

					<li>${inconsistentAbsence.get(person, day)} per <em>${person}</em> nel giorno ${day} ${mese} ${anno}</li>
			%{
						}
					}
				}
				}
			}%
      		</div>
      		
      		
      		<div class="date">
      			<strong>Data</strong> &nbsp;&nbsp;${today.getDayOfMonth()}/${today.getMonthOfYear()}/${today.getYear()}
      		</div>
      		<div class="firma dir">
      			<strong>Il Direttore</strong> <br />
      			Dott. Domenico Laforenza
      		</div>
      
     		<div class="firma resp">
      			<strong>Il Responsabile</strong><br />
      			Dott. Maurizio Martinelli
      		</div>
      		
    </body>
</html>