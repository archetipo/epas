
 <!--  ferie anno passato -->
   #{if activeVacationLastYear }
      %{ recap = vacationsRecap.vacationsLastYear;
         recapYear = (vacationsRecap.vacationsRequest.year - 1); 
         recapLabel = 'Ferie Competenza ' + (recapYear);   
      }%   
   #{/if}
   <!--  ferie anno passato -->
   #{if activeVacationCurrentYear }
      %{ recap = vacationsRecap.vacationsCurrentYear;
         recapYear = vacationsRecap.vacationsRequest.year; 
         recapLabel = 'Ferie Competenza ' + (recapYear);
      }%   
   #{/if}
   <!--  permessi -->
   #{if activePermission }
      %{ recap = vacationsRecap.permissions;
         recapYear = vacationsRecap.vacationsRequest.year; 
         recapLabel = 'Permessi Competenza ' + (recapYear);   
      }%   
   #{/if}

#{modalAsync title: vacationsRecap.vacationsRequest.contract.person.fullname + ' - ' + recapLabel }

  
<div>
 
   #{tabs}
    
    #{tabItem id:'infoTot', title:'Riepilogo', active:true /}
    #{tabItem id:'date', title:'Date Utilizzo' /}
    #{tabItem id:'calcTot', title:'Calcolo Giorni Totali' /}
    #{tabItem id:'calcAcc', title:'Calcolo Giorni Maturati' /}
    
  
  #{/tabs}
  
  <br>

   #{tabContent}
   
     #{tabContentItem id:'date' }
     
         #{if recap.sourced > 0}
	        <div class="alert alert-success">
				<p><strong>${recap.sourced}</strong> giorni utilizzati sono stati definiti da
				da inizializzazione ePAS.</p>
			</div>	
		  #{/if}
       
         <div class="col-md-8 col-md-offset-2">
	        <table class="table table-condensed table-hover" datatable-small>
				    
			<thead>
			  <tr class="warning">
				 <th class="col-xs-4">Data</th>
			     <th class="col-xs-2">Codice</th>
			     <th class="col-xs-6">Descrizione</th>
			  </tr>
			</thead>
			<tbody>
			#{list items:recap.absencesUsed, as:'absence'}
			    <tr>
			       <td data-order="${absence.personDay.date}">${absence.personDay.date.format()}</td>
			       <td>${absence.absenceType.code}</td>
			       <td>${absence.absenceType.description}</td>
			    </tr>
			#{/list}
			</tbody>
		    </table>
          </div>
          
          <br>
   
	 #{/tabContentItem}  
	   
	 #{tabContentItem id:'infoTot', active:true}
	 
		 <div class="col-md-6 col-md-offset-3">
		   <table class="table">
		     <tr>
		       <td><strong>Totali</strong></td>
		       <td>${recap.total}</td>
		     </tr>
		     <tr>
		       <td><strong>Maturate</strong></td>
		       <td>${recap.accrued}</td>
		     </tr>
		     <tr>
		       <td><strong>Usate</strong></td>
		       <td>${recap.used}</td>
		     </tr>
		   </table>
	   </div>
	   
	   <div class="col-md-12">
	   #{alert color:'info'}
	   <p>Le assenze <strong>Prendibili</strong> sono le assenze maturate che il dipendente pu√≤ effettivamente utilizzare in questo
	   momento.</p>
	      <p>Le assenze <strong>Rimanenti</strong> sono tutte le assenze (maturate e non) residue per il dipendente.</p>
	   #{/alert}
	   </div>
	   
	   <div class="col-md-6 col-md-offset-3">
		   <table class="table">
		     <tr>
		       <td><strong>Prendibili</strong></td>
		       <td>${recap.notYetUsedTakeable}</td>
		     </tr>
		     <tr>
		       <td><strong>Rimanenti</strong></td>
		       <td>${recap.notYetUsedTotal}</td>
		     </tr>
		     <tr>
		       <td><strong>Limite Massimo Utilizzo</strong></td>
		       <td>${recap.upperLimit.format()}</td>
		     </tr>
		   </table>
	   </div>
	   
	   
    #{/tabContentItem}
    
    #{tabContentItem id:'calcTot'}
    
       #{alert color:'info'}
	     <p>Sono stati calcolati <strong>${recap.total}</strong> giorni totali.</p>
	   #{/alert}
	   
	     #{list items:recap.totalResult.accruedResultsInPeriod, as:'accruedResultInPeriod'}
	       #{if accruedResultInPeriod.interval != null}
	       <table class="table table-condensed">
	         <tr>
	           <td>Piano Ferie</td>
	           <td>${accruedResultInPeriod.vacationCode.description}</td>
	         </tr>
	         <tr>
	           <td>Intervallo</td>
	           <td>Dal <strong>${accruedResultInPeriod.interval.begin.format()}</strong> al <strong>${accruedResultInPeriod.interval.end.format()}</strong></td>
	         </tr>
	         

	         #{if accruedResultInPeriod.postPartum.size() > 0 }
	         <tr>
	           <td>Giorni nell'intervallo</td>
	           <td><strong>+ ${accruedResultInPeriod.days + accruedResultInPeriod.postPartum.size()}</strong></td>
	         </tr>
	         <tr>
	           <td>Giorni congedo parentale</td>
	           <td><strong>- ${accruedResultInPeriod.postPartum.size()}</strong></td>
	         </tr>
	         <tr>
	           <td>Giorni considerati</td>
	           <td><strong>${accruedResultInPeriod.days}</strong></td>
	         </tr>
	         #{/if}
	         #{else}
			 <tr>
	           <td>Giorni considerati</td>
	           <td><strong>${accruedResultInPeriod.days}</strong></td>
	         </tr>	         
	         #{/else}
	         <tr>
	           <td>Giorni calcolati</td>
	           <td><strong>${accruedResultInPeriod.accrued}</strong></td>
	         </tr>	  
	         
	       </table>
	       #{/if}
        #{/list}
    
    #{/tabContentItem}
    
    #{tabContentItem id:'calcAcc'}
       #{alert color:'info'}
	     <p>Sono stati calcolati <strong>${recap.accrued}</strong> giorni maturati.</p>
	   #{/alert}
	   
	     #{list items:recap.accruedResult.accruedResultsInPeriod, as:'accruedResultInPeriod'}
	       #{if accruedResultInPeriod.interval != null}
	       <table class="table table-condensed">
	         <tr>
	           <td>Piano Ferie</td>
	           <td>${accruedResultInPeriod.vacationCode.description}</td>
	         </tr>
	         <tr>
	           <td>Intervallo</td>
	           <td>Dal <strong>${accruedResultInPeriod.interval.begin.format()}</strong> al <strong>${accruedResultInPeriod.interval.end.format()}</strong></td>
	         </tr>
	         

	         #{if accruedResultInPeriod.postPartum.size() > 0 }
	         <tr>
	           <td>Giorni nell'intervallo</td>
	           <td><strong>+ ${accruedResultInPeriod.days + accruedResultInPeriod.postPartum.size()}</strong></td>
	         </tr>
	         <tr>
	           <td>Giorni congedo parentale</td>
	           <td><strong>- ${accruedResultInPeriod.postPartum.size()}</strong></td>
	         </tr>
	         <tr>
	           <td>Giorni considerati</td>
	           <td><strong>${accruedResultInPeriod.days}</strong></td>
	         </tr>
	         #{/if}
	         #{else}
			 <tr>
	           <td>Giorni considerati</td>
	           <td><strong>${accruedResultInPeriod.days}</strong></td>
	         </tr>	         
	         #{/else}
	         <tr>
	           <td>Giorni calcolati</td>
	           <td><strong>${accruedResultInPeriod.accrued}</strong></td>
	         </tr>	  
	         
	       </table>
	       #{/if}
        #{/list}
        
    #{/tabContentItem}
    
    
  #{/tabContent}  

</div>          
 
#{/modalAsync}        

