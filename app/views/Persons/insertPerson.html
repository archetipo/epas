#{extends 'main3.html' /}
#{set header:'navbar' /}
#{set title: 'ePAS - Inserimento nuova persona' /}
<div class="container">
#{form @Persons.save()}

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title"><span class="badge">1</span> Dati Personali</h3>
  </div>
  <div class="panel-body">

    <table class="table table-condensed table-form table-hover">
    #{f.input_table 'person.surname', required:'true', type:'text' /}
		#{f.input_table 'person.name', required:'true', type:'text'/}
	 	#{f.input_table 'person.number', type:'number'/}
	 	#{f.input_table 'person.badgeNumber', type:'number'/}
		#{f.select_table 'qualification', value: qualification, items:templateUtility.allQualifications, required:'true'/}
		#{f.select_table 'office', value: office, items:templateUtility.allOfficesAllowed, required:'true'/}
    #{f.input_table 'person.email', type:'email' , required:'true' /}
		#{f.checkbox_table 'person.wantEmail'/}
	</table>
    <p>
  	   Abilitando l'invio mail per il dipendente, si permetterà alle procedure di controllo sui 
  	   <strong><em>giorni con timbrature disaccoppiate</em></strong> e sui
  	   <strong><em>giorni con mancanza di timbrature e codici assenza</em></strong>, di inviare una mail
      	al dipendente contenente i giorni in cui sono stati riscontrati i casi descritti.
  	</p>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title"><span class="badge">2</span> Dati Contrattuali</h3>
  </div>
  <div class="panel-body">
	
   <table class="table table-condensed table-form table-hover">
		
     #{f.datepicker_table 'contract.beginContract', required:'true' /}
   	 #{f.datepicker_table 'contract.expireContract' /}
	 #{f.checkbox_table 'contract.onCertificate', required:'true' /}				
   </table>
  	  
  	  <p>
  	    Alla creazione del contratto verrà assegnato il tipo orario di default <strong><em>Normale</em></strong>.<br>
  	    Sarà possibile modificarlo in un secondo momento scegliendo fra i tipi orario definiti per la sede selezionata.<br>
  	    <strong>Importante:</strong> Per motivi di sicurezza al personale non in Attestati non può essere attribuito 
  	    alcun ruolo amministrativo ePAS.
  	  </p>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title"><span class="badge">3</span> Informazioni di ubicazione e contatti (opzionali)</h3>
  </div>
  <div class="panel-body">
	
    <table class="table table-condensed table-form table-hover">
    	#{f.input_table 'person.telephone', type:'text' /}
      #{f.input_table 'person.cnr_email', type:'email' /}
      #{f.input_table 'person.eppn', type:'text' /}
    	#{f.datepicker_table 'person.birthday', type:'text' /}
    </table>

  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title"><span class="badge">4</span>Username</h3>
  </div>
  <div class="panel-body">
  
    <table class="table table-condensed table-form table-hover">
  #{field 'userName'}
  <div class='form-group col-sm-6 col-sm-offset-3 #{if field.error}has-error#{/if}' >
    <label class="control-label" for="${field.id}">Scelta Username</label>
    #{select field.id, id:field.id,class:'form-control'}
    #{/select}
    #{if field.error}<span class="help-block">${field.error}</span>#{/if}
  </div>
  #{/field}
    </table>

  </div>
</div>

   <div class="container-fluid center">
      <input class="btn btn-primary" type="submit" value="Salva" />
      <a href="@{ Persons.list() }" class="btn btn-default" role="button">Annulla</a>
   </div>

#{/form}
</div>    

#{set 'moreScripts'}
<script type="text/javascript">

 $(document).ready( function (){

  generateUserName($("#person\\.name"),$("#person\\.surname"),$("#userName"));
  
  $('#person\\.surname').keyup(function(){
    generateUserName($("#person\\.name"),$("#person\\.surname"),$("#userName"));
  });

  $('#person\\.name').keyup(function(){
     generateUserName($("#person\\.name"),$("#person\\.surname"),$("#userName"));
  });

});
</script>
#{/set}

