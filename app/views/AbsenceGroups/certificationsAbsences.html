#{extends 'main.html' /}
#{set header:'navbar' /}
#{set title: 'ePAS - Assenze Attestati'  /}

<div class="container">

#{alert color:'info'}
 <p>Cruscotto ${person.fullname} anno ${yearSituation.year}.</p>
 <p>Data Inizio <strong>${yearSituation.beginDate.format()}</strong></p>
 <p>#{if yearSituation.endDate} Data Fine <strong>${yearSituation.endDate.format()} #{/if}</strong></p>
#{/alert}


<table class="table table-bordered table-condensed table-hover"> 
  <thead>
  <tr>
    <th>Tipo</th>
    <th>Ok</th>
    <th>Add</th>
    <th>Remove</th>
  </tr>
  </thead>
  <tbody>
  #{list items:yearSituation.absenceSituations, as:'absenceSituation'}
     <tr>
     <td>${absenceSituation.type}</td>
     
     <td>
     #{list items:absenceSituation.datesPerCodeOk.keySet(), as:'code'}
     #{list items:absenceSituation.datesPerCodeOk.get(code), as:'date'}
      <i class="fa fa-check text-success" aria-hidden="true"></i><a href="@{Stampings.personStamping(yearSituation.person.id, date.year, date.monthOfYear)}">${code} ${date.format()}</a><br>
     #{/list}  
     #{/list}
     </td>
     
     <td>
     #{list items:absenceSituation.toAddAutomatically.keySet(), as:'code'}
     #{list items:absenceSituation.toAddAutomatically.get(code), as:'date'}
      <i class="fa fa-plus text-warning" aria-hidden="true"></i><a href="@{Stampings.personStamping(yearSituation.person.id, date.year, date.monthOfYear)}">${code} ${date.format()}</a><br>
     #{/list}  
     #{/list}
     #{list items:absenceSituation.toAddManually.keySet(), as:'code'}
     #{list items:absenceSituation.toAddManually.get(code), as:'date'}
      <i class="fa fa-plus text-danger" aria-hidden="true"></i><a href="@{Stampings.personStamping(yearSituation.person.id, date.year, date.monthOfYear)}">${code} ${date.format()}</a><br>
     #{/list}  
     #{/list}
     </td>
     
     <td>
     #{list items:absenceSituation.notPresentSent, as:'absence'}
      <i class="fa fa-times text-danger" aria-hidden="true"></i><a href="@{Stampings.personStamping(yearSituation.person.id, absence.absenceDate.year, absence.absenceDate.monthOfYear)}">${absence.absenceType.code} ${absence.absenceDate.format()}</a><br>
     #{/list}
     #{list items:absenceSituation.notPresent, as:'absence'}
      <i class="fa fa-times text-warning" aria-hidden="true"></i><a href="@{Stampings.personStamping(yearSituation.person.id, absence.absenceDate.year, absence.absenceDate.monthOfYear)}">${absence.absenceType.code} ${absence.absenceDate.format()}</a><br>
     #{/list}
     </td>
    </tr>
  #{/list}
  </tbody>
</table>

<a class="btn btn-warning" href="@{AbsenceGroups.importCertificationsAbsences(yearSituation.person.id, yearSituation.year)}">Importa Assenze Importabili Automaticamente</a>



</div>