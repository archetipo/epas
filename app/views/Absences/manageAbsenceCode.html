#{extends 'main.html' /}
#{set header:'navbar' /}
#{set title:'ePAS - Codici di assenza' /}

#{secure.checkAction 'Absences.insertCode' }
<div class="row text-center">
	#{secure.link @Absences.insertCode(), class:'btn btn-primary',fa:'plus' }
		<em>Definisci nuovo codice di assenza</em>
	#{/secure.link}
</div>
#{/secure.checkAction}

	<table class="table table-striped table-hover" width="100%" datatable>
	 <thead>
	  <tr>
	  	<th>&{'absenceType.code'}</th>
	  	<th>&{'absenceType.certificateCode'}</th>
	  	<th>&{'absenceType.description'}</th>
	  	<th>&{'absenceType.internalUse'}</th>
	  	<th>&{'absenceType.consideredWeekEnd'}</th>
	  	<th>&{'absenceType.validFrom'}</th>
	  	<th>&{'absenceType.validTo'}</th>
	  	<th>&{'absenceType.justifiedTimeAtWork'}</th>
	  	<th>&{'absenceType.qualifications'}</th>

	  	<th>&{'absenceTypeGroup.label'}</th>
	  	<th>&{'absenceTypeGroup.minutesExcess'}</th>
	  	<th>&{'absenceTypeGroup.accumulationType'}</th>
	  	<th>&{'absenceTypeGroup.limitInMinute'}</th>
	  	<th>&{'absenceTypeGroup.accumulationBehaviour'}</th>
	  	<th>&{'absenceTypeGroup.replacingAbsenceType'}</th>
	  </tr>
	</thead>
	<tbody>
		#{list absenceTypes}
		<tr>
			<td class="caratteristica"><a href="@{Absences.editCode(_.id)}">${_.code}</a></td>
			<td>${_.certificateCode}</td>
			<td>${_.description}</td>
			<td>${_.internalUse ? 'Sì' : 'No'}</td>
	
			<td>${_.consideredWeekEnd ? 'Sì' : 'No'}</td>
			<td>${_.validFrom?.format()}</td>
			<td>${_.validTo?.format()}</td>
			<td>${_.justifiedTimeAtWork?.label()}</td>
			<td>
				#{list items:_.qualifications, as: 'q'}
					${q.qualification}#{if !q_isLast},#{/if}
				#{/list}
			</td> 
			<td>${_.absenceTypeGroup?.label}</td>
			<td>${_.absenceTypeGroup?.minutesExcess}</td>
			<td>${_.absenceTypeGroup?.accumulationType?.label()}</td>
			<td>${_.absenceTypeGroup?.limitInMinute}</td>
			<td>${_.absenceTypeGroup?.accumulationBehaviour?.label()}</td>
			<td>${_.absenceTypeGroup?.replacingAbsenceType?.code}</td>
		</tr>
		#{/list}
		</tbody>
	</table>
