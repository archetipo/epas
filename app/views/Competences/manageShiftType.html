#{extends 'main.html' /}
#{set header:'navbar' /}
#{set title: 'ePAS - Gestisci ' + type.description /}

#{set breadcrumbs:['Gestisci servizi':@Competences.activateServices(type.shiftCategories.office.id), 
  (type.description):null] /}
#{breadcrumbs breadcrumbs, noHome:true, container:true /}

<div class="container">

#{title title:'Gestisci attività', administration:true /}
	
#{form action:@Competences.linkPeopleToShift(), class:'form form-horizontal', 
	'data-async':'#page_content', 'data-async-error':'#absenceCodeData',
	'data-spinner':'#defaultSpinner' }
  	#{if type.persistent}
 		#{f.hidden 'type.id' /}
	#{/if}
	#{alert color: 'info'}
		Il nome e la descrizione della attività possono essere cambiati in qualsiasi momento.
	#{/alert}
	#{f.input 'type.type' /}
	#{f.input 'type.description' /}
	#{f.input 'type.tolerance',type:'number' /}
	#{f.input 'type.hourTolerance', type:'number' /}		
  
	  #{b.buttons center:true}
	  		#{b.submit 'Ok'/}
	  #{/b.buttons}

#{/form}
	#{if peopleForShift.isEmpty()}
		#{alert color:'warning'}
			Per poter assegnare dei dipendenti all'attività <strong>${type.description}</strong>
			occorre prima abilitare la competenza turno ai dipendenti stessi andando su: <br>
			<i>Amministrazione</i> <i class="fa fa-long-arrow-right" aria-hidden="true"></i> 
			<i>Competenze</i> <i class="fa fa-long-arrow-right" aria-hidden="true"></i>
			<i>Abilita competenze</i>
		#{/alert}
	#{/if}
	#{else}	
	<div class="text-center">
    <a class="btn btn-success" href="@{Competences.linkPeopleToShift(type.id)}" data-async-modal="#modalAddPersonToActivity"><i class="fa fa-user-plus"></i>
      Inserisci una nuova persona sull'attività</a>
  	</div>
	<table class="table table-striped table-hover table-condensed center" datatable>
	<thead>
    <tr>
      <th>Nome</th>
      <th>Inizio attività di turno</th>
      <th>Fine attività di turno</th>
      <th>Jolly</th>
    </tr>
    </thead>
    <tbody>
	#{list items:associatedPeopleShift, as:'person'}
	<tr>
		<td>${person.person.fullname()}</td>
		<td>${person.beginDate}</td>
		<td>${person.endDate}</td>
		<td>${person.jolly}</td>
	</tr>
	#{/list}
	</tbody>
	</table>
		
	#{/else}
</div>

<div id="modalAddPersonToActivity" class="modal fade container" tabindex="-1"></div>
