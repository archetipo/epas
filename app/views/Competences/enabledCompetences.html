#{extends 'main3.html' /}
#{set header:'navbar' /}
#{set title: 'ePAS - Abilita competenze'  /}


<div id="container-fluid-nav-tabs" class="container-fluid">

<ul class="nav nav-tabs">
  <li><a href="@{Competences.showCompetences(year, month, office.id)}">Assegna Competenze</a></li>
  <li><a href="@{Competences.overtime(year, month, office.id)}">Straordinari</a></li>
  <li><a href="@{Competences.totalOvertimeHours(year, office.id)}">Monte ore</a></li>
  <li class="active"><a href="@{Competences.enabledCompetences(office.id)}">Abilita Competenze</a></li>
  <li><a href="@{Competences.exportCompetences()}">Esporta competenze</a></li>
</ul>

</div>
 
<div class="container-fluid">

<!-- FILTRO OFFICE RIPETUTO IN OGNI TEMPLATE DI COMPETENCES, DA METTERE NEL NAVBAR?? -->
<div class="container-fluid">
 <div class="center" style="margin-top: 0px; margin-bottom: 10px;">
	  #{form action:@Competences.enabledCompetences(), role:'form', class:'form-inline', 
	    method:'GET', autocomplete:'off',
	    'data-reload':'#results'}
	    
	       <div class="form-group">
	        <label class="hidden-xs hidden-sm" for="dip">Sede </label>
	        	        	        
	        <select name="officeId" class="form-control" id="dip" onChange="javascript:this.form.submit()" >
	            #{list items:offices, as:'officeItem'}
	              <option value="${officeItem.id}" #{if officeItem.id.equals(office.id) } selected="selected" #{/if} >
	                ${officeItem.name}
	              </option>
	            #{/list}
	        </select>
	      </div>
	       
	      <button type="submit" class="btn btn-default">Invio</button>
	  #{/form}
      </div>
</div>
<!-- FINE FILTRO OFFICE -->

#{form action:@Competences.enabledCompetences(), class:'form-search',  
    method:'GET', autocomplete:'off',
    'data-reload':'#results'}
    
    <input type="text" name="name" placeholder="Nome o cognome" value="${name}" class="input-medium search-query"/>
    <i class="icon-search icon-large"></i>
    <input type="hidden" name="officeId" value="${office.id}"/>

#{/form}

<br>

 <section id="results"> 

  <table class="table table-condensed table-hover center">
	<tr>
		<th>Nome</th>
		%{for(col in tableRecapCompetence.columnKeySet()){
		}%
		<th>${col}</th>
	%{
		}
	}%
	</tr>

	%{  for(entry in tableRecapCompetence.rowMap().entrySet()){
		}%
	<tr>
		<td>
		  <a data-toggle="modal" href="@{Competences.updatePersonCompetence(entry.getKey().id)}" data-modal=".my-modal"> 
		    ${entry.getKey().name} ${entry.getKey().surname}
		  </a>
		</td>
		
		%{ for(col in tableRecapCompetence.columnKeySet()){
		}%
		%{ if(entry.getValue().get(col) == true){
		}%	<td>	
				<span class="glyphicon glyphicon-ok"></span>
			</td>
		%{ 
		}else{
		}%
			<td>	
				
			</td>
		%{
			}
		}%
		%{
		   }
		}%
	</tr>	
	%{
		}
	}%
  </table>
 </section> 
</div>

#{include '_myModal.html' /}


